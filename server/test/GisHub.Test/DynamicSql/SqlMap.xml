<?xml version="1.0" encoding="utf-8" ?>
<SmartSqlMap xmlns="http://SmartSql.net/schemas/SmartSqlMap.xsd" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://SmartSql.net/schemas/SmartSqlMap.xsd xsd/SmartSqlMap.xsd"
  Scope="DynamicSqlTest">
  <Statements>
    <Statement Id="is-not-empty">
      select fid, id, name, area
      from public.sr4326_cn_sar_dist
      <Where>
        <IsNotEmpty Property="id" Prepend="and">
          id like @id || '%'
        </IsNotEmpty>
        <IsNotEmpty Property="area" Prepend="or">
          area >= @area
        </IsNotEmpty>
        <IsEmpty Property="moniDate" Prepend="and">
          moni_date = (select max(moni_date) from public.xxx where public.xxx.moni_date > now )
        </IsEmpty>
        <IsNotEmpty Property="moniDate" Prepend="and">
          moni_date = @moniDate
        </IsNotEmpty>
      </Where>
    </Statement>

    <Statement Id="for">
      select fid, id, name, area
      from public.sr4326_cn_sar_dist
      <Dynamic Prepend="where">
        <IsNotEmpty Prepend="and" Property="area">
          <![CDATA[area >= @area]]>
        </IsNotEmpty>
        <For Prepend="and" Key="key" Open="(" Close=")" Property="names" Separator="or">
          name like Concat(@key,'%')
        </For>
        <For Property="idArr" Open="id in (" Separator="," Close=")" Key="idArr">
          @idArr
        </For>
      </Dynamic>
    </Statement>
  </Statements>
</SmartSqlMap>
